<!DOCTYPE html>
<html lang="en">

<head>
    <title>Unity Physics 学习笔记第六章：触发器事件与碰撞事件 | Celestial</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="robots" content="noodp"/>

    <link rel="stylesheet" href="https://paakmau.github.io/style.css">
    <link rel="stylesheet" href="https://paakmau.github.io/color/orange-auto.css">

        <link rel="stylesheet" href="https://paakmau.github.io/color/background_auto.css">
    
    <link rel="stylesheet" href="https://paakmau.github.io/font-hack-subset.css">

    <meta name="description" content="">

    <meta property="og:description" content="">
    <meta property="og:title" content="Unity Physics 学习笔记第六章：触发器事件与碰撞事件 | Celestial">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://paakmau.github.io/202002110101/">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="">
    <meta name="twitter:title" content="Unity Physics 学习笔记第六章：触发器事件与碰撞事件 | Celestial">
    <meta property="twitter:domain" content="paakmau.github.io">
    <meta property="twitter:url" content="https://paakmau.github.io/202002110101/">

                <link rel="alternate" type="application/rss+xml" title="Celestial RSS Feed" href="https://paakmau.github.io/rss.xml" />
                <link rel="alternate" type="application/atom+xml" title="Celestial Atom Feed" href="https://paakmau.github.io/atom.xml" />
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'neutral'
        });
    </script>
</head>

<body class="">
<div class="container">
    
    <header class="header">
        <div class="header__inner">
            <div class="header__logo">
                    
                <a href="https://paakmau.github.io" style="text-decoration: none;">
                    <div class="logo">
                      
                            Celestial
                        
                    </div>
                </a>
            </div>
        </div>

        
        
                <nav class="menu">
            <ul class="menu__inner">
                <li class="active"><a href="https://paakmau.github.io">home</a></li>
            
                <li><a href="https://paakmau.github.io/tags">tags</a></li>
            
                <li><a href="https://github.com/paakmau" target="_blank" rel="noopener noreferrer">github</a></li>
            </ul>
        </nav>
    
    
        
    </header>
    

    <div class="content">
        
    <div class="post">
        
    <h1 class="post-title"><a href="https://paakmau.github.io/202002110101/">Unity Physics 学习笔记第六章：触发器事件与碰撞事件</a></h1>
    <div class="post-meta-inline">
        
    <span class="post-date">
            2020-02-11
        </span>

    </div>

    
        <span class="post-tags-inline">
                :: tags:&nbsp;
                <a class="post-tag" href="https://paakmau.github.io/tags/unity-ecs/">#Unity ECS</a>&nbsp;
                <a class="post-tag" href="https://paakmau.github.io/tags/unity-physics/">#Unity Physics</a></span>
    

        <div class="post-content">
            <p>这部分内容手册中没有，本文参考的是官方示例代码与官方论坛<br></p>
<p><a href="https://github.com/Unity-Technologies/EntityComponentSystemSamples">https://github.com/Unity-Technologies/EntityComponentSystemSamples</a></p>
<span id="continue-reading"></span>
<p>在 OOP 的物理引擎中，碰撞发生后引擎可以通过调用用户提供的回调函数将碰撞事件传递给用户程序。而在 Unity 的 ECS 框架中我们需要使用数据驱动的思路来处理碰撞<br>
但是引擎已经把事件处理封装好了，因此我们实现的时候其实看起来跟回调差不多</p>
<h2 id="jian-jie">简介</h2>
<p>Unity Physics 中，刚体可以通过 Trigger 或者 Collision 触发事件，需要勾选 <code>Physics Shape</code> 中的 <code>Is Trigger</code> 或 <code>Raises Collision Events</code><br>
它们的区别在于 Trigger 不会引起物理上的碰撞，只产生事件</p>
<p>对于产生的 Trigger 事件或 Collision 事件，我们可以通过 <code>ITriggerEventsJob</code> 或 <code>ICollisionEventsJob</code> 来获取并处理</p>
<p>下面的例子可以实现这样的效果<br>
开始时所有的刚体不受重力影响，但是一个刚体被 Trigger 碰到后它就会重新受到重力并下坠</p>
<h2 id="zhun-bei-trigger">准备 Trigger</h2>
<p>首先准备一个 Entity 作为 Trigger，并且让他受到键盘控制运动。<br>
新建一个 Cube 的 GameObject，移除 <code>Box Collider</code>，添加 <code>Convert To Entity</code>，<code>Physics Body</code>，<code>Physics Shape</code>。在 <code>Physics Body</code> 中把重力系数设为 0，在 <code>Physics Shape</code> 中勾选 <code>Is Trigger</code><br>
然后使用 Authoring 为它添加 <code>PlayerInput</code> 组件。</p>
<p>保存键盘输入的组件<br>
<code>PlayerInput.cs</code></p>
<pre data-lang="cs" style="background-color:#151515;color:#e8e8d3;" class="language-cs "><code class="language-cs" data-lang="cs"><span>[</span><span style="color:#ffb964;">Serializable</span><span>]
</span><span style="color:#8fbfdc;">public struct </span><span style="color:#ffb964;">PlayerInput </span><span>: </span><span style="color:#ffb964;">IComponentData </span><span>{
</span><span>    </span><span style="color:#8fbfdc;">public </span><span>float2 </span><span style="color:#ffb964;">moveDirection</span><span>;
</span><span>}
</span></code></pre>
<p>获取键盘输入的系统<br>
<code>FetchInputSystem.cs</code></p>
<pre data-lang="cs" style="background-color:#151515;color:#e8e8d3;" class="language-cs "><code class="language-cs" data-lang="cs"><span style="color:#8fbfdc;">public class </span><span style="color:#ffb964;">FetchInputSystem </span><span>: </span><span style="color:#ffb964;">ComponentSystem </span><span>{
</span><span>    </span><span style="color:#8fbfdc;">protected override void </span><span style="color:#fad07a;">OnUpdate </span><span>() {
</span><span>        float2 </span><span style="color:#ffb964;">dir </span><span>= </span><span style="color:#ffb964;">float2</span><span>.</span><span style="color:#ffb964;">zero</span><span>;
</span><span>        </span><span style="color:#8fbfdc;">if </span><span>(</span><span style="color:#ffb964;">UnityEngine</span><span>.</span><span style="color:#ffb964;">Input</span><span>.</span><span style="color:#ffb964;">GetKey</span><span>(</span><span style="color:#ffb964;">UnityEngine</span><span>.</span><span style="color:#ffb964;">KeyCode</span><span>.</span><span style="color:#ffb964;">A</span><span>))
</span><span>            </span><span style="color:#ffb964;">dir </span><span>+= new float2 (-</span><span style="color:#cf6a4c;">1</span><span>, </span><span style="color:#cf6a4c;">0</span><span>);
</span><span>        </span><span style="color:#8fbfdc;">if </span><span>(</span><span style="color:#ffb964;">UnityEngine</span><span>.</span><span style="color:#ffb964;">Input</span><span>.</span><span style="color:#ffb964;">GetKey</span><span>(</span><span style="color:#ffb964;">UnityEngine</span><span>.</span><span style="color:#ffb964;">KeyCode</span><span>.</span><span style="color:#ffb964;">D</span><span>))
</span><span>            </span><span style="color:#ffb964;">dir </span><span>+= new float2 (</span><span style="color:#cf6a4c;">1</span><span>, </span><span style="color:#cf6a4c;">0</span><span>);
</span><span>        </span><span style="color:#8fbfdc;">if </span><span>(</span><span style="color:#ffb964;">UnityEngine</span><span>.</span><span style="color:#ffb964;">Input</span><span>.</span><span style="color:#ffb964;">GetKey</span><span>(</span><span style="color:#ffb964;">UnityEngine</span><span>.</span><span style="color:#ffb964;">KeyCode</span><span>.</span><span style="color:#ffb964;">W</span><span>))
</span><span>            </span><span style="color:#ffb964;">dir </span><span>+= new float2 (</span><span style="color:#cf6a4c;">0</span><span>, </span><span style="color:#cf6a4c;">1</span><span>);
</span><span>        </span><span style="color:#8fbfdc;">if </span><span>(</span><span style="color:#ffb964;">UnityEngine</span><span>.</span><span style="color:#ffb964;">Input</span><span>.</span><span style="color:#ffb964;">GetKey</span><span>(</span><span style="color:#ffb964;">UnityEngine</span><span>.</span><span style="color:#ffb964;">KeyCode</span><span>.</span><span style="color:#ffb964;">S</span><span>))
</span><span>            </span><span style="color:#ffb964;">dir </span><span>+= new float2 (</span><span style="color:#cf6a4c;">0</span><span>, -</span><span style="color:#cf6a4c;">1</span><span>);
</span><span>        </span><span style="color:#ffb964;">dir </span><span>= </span><span style="color:#ffb964;">math</span><span>.</span><span style="color:#ffb964;">normalizesafe</span><span>(</span><span style="color:#ffb964;">dir</span><span>);
</span><span>        </span><span style="color:#ffb964;">Entities</span><span>.</span><span style="color:#ffb964;">ForEach</span><span>((ref PlayerInput </span><span style="color:#ffb964;">input</span><span>) </span><span style="color:#8fbfdc;">=&gt; </span><span>{
</span><span>            </span><span style="color:#ffb964;">input</span><span>.</span><span style="color:#ffb964;">moveDirection </span><span>= </span><span style="color:#ffb964;">dir</span><span>;
</span><span>        });
</span><span>    }
</span><span>}
</span></code></pre>
<p>根据得到的键盘输入控制 Trigger 移动的系统<br>
<code>MoveSystem.cs</code></p>
<pre data-lang="cs" style="background-color:#151515;color:#e8e8d3;" class="language-cs "><code class="language-cs" data-lang="cs"><span style="color:#8fbfdc;">public class </span><span style="color:#ffb964;">MoveSystem </span><span>: </span><span style="color:#ffb964;">JobComponentSystem </span><span>{
</span><span>    [</span><span style="color:#ffb964;">BurstCompile</span><span>]
</span><span>    </span><span style="color:#8fbfdc;">struct </span><span style="color:#ffb964;">MoveJob </span><span>: </span><span style="color:#ffb964;">IJobForEach</span><span>&lt;PlayerInput, PhysicsVelocity&gt; {
</span><span>        </span><span style="color:#8fbfdc;">public void </span><span style="color:#fad07a;">Execute </span><span>([</span><span style="color:#ffb964;">ReadOnly</span><span>] </span><span style="color:#8fbfdc;">ref </span><span>PlayerInput </span><span style="color:#ffb964;">input</span><span>, </span><span style="color:#8fbfdc;">ref </span><span>PhysicsVelocity </span><span style="color:#ffb964;">velocity</span><span>) {
</span><span>            </span><span style="color:#8fbfdc;">var </span><span style="color:#ffb964;">v </span><span>= </span><span style="color:#ffb964;">velocity</span><span>.</span><span style="color:#ffb964;">Linear</span><span>;
</span><span>            </span><span style="color:#ffb964;">v </span><span>= new float3 (</span><span style="color:#ffb964;">input</span><span>.</span><span style="color:#ffb964;">moveDirection</span><span>, </span><span style="color:#cf6a4c;">0</span><span>) * </span><span style="color:#cf6a4c;">1.8</span><span style="color:#8fbfdc;">f</span><span>;
</span><span>            </span><span style="color:#ffb964;">velocity </span><span>= new PhysicsVelocity { </span><span style="color:#ffb964;">Linear </span><span>= </span><span style="color:#ffb964;">v </span><span>};
</span><span>        }
</span><span>    }
</span><span>    </span><span style="color:#8fbfdc;">protected override </span><span>JobHandle </span><span style="color:#fad07a;">OnUpdate </span><span>(JobHandle </span><span style="color:#ffb964;">inputDeps</span><span>) {
</span><span>        </span><span style="color:#8fbfdc;">return </span><span>new MoveJob ().</span><span style="color:#ffb964;">Schedule </span><span>(</span><span style="color:#ffb964;">this</span><span>, </span><span style="color:#ffb964;">inputDeps</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<h2 id="zhun-bei-yong-yu-bei-hong-fa-de-entity">准备用于被触发的 Entity</h2>
<p>然后准备另一个用于被触发的 Entity，它至少需要有 <code>Physics Shape</code>、<code>Physics Body</code><br>
当然要在 <code>Physics Body</code> 中将重力系数设为 0</p>
<h2 id="chu-li-trigger-shi-jian">处理 Trigger 事件</h2>
<p>写一个简单的 <code>JobComponentSystem</code> 就行了<br>
只是其中的 Job 需要使用 <code>ITriggerEventsJob</code> 接口，个人感觉是物理引擎 Simulate 之后会产生 Trigger 事件的数组，然后通过 <code>ITriggerEventsJob</code> 来遍历它处理每个 Trigger 事件</p>
<p><code>DetectTriggerSystem.cs</code></p>
<pre data-lang="cs" style="background-color:#151515;color:#e8e8d3;" class="language-cs "><code class="language-cs" data-lang="cs"><span>[</span><span style="color:#ffb964;">UpdateAfter</span><span> (</span><span style="color:#ffb964;">typeof</span><span> (</span><span style="color:#ffb964;">EndFramePhysicsSystem</span><span>))]
</span><span style="color:#8fbfdc;">public class </span><span style="color:#ffb964;">DetectTriggerSystem </span><span>: </span><span style="color:#ffb964;">JobComponentSystem </span><span>{
</span><span>    [</span><span style="color:#ffb964;">BurstCompile</span><span>]
</span><span>    </span><span style="color:#8fbfdc;">struct </span><span style="color:#ffb964;">DetectTriggerJob </span><span>: </span><span style="color:#ffb964;">ITriggerEventsJob </span><span>{
</span><span>        [</span><span style="color:#ffb964;">ReadOnly</span><span>] </span><span style="color:#8fbfdc;">public </span><span>ComponentDataFromEntity&lt;PlayerInput&gt; </span><span style="color:#ffb964;">playerInputGroup</span><span>;
</span><span>        </span><span style="color:#8fbfdc;">public </span><span>ComponentDataFromEntity&lt;PhysicsGravityFactor&gt; </span><span style="color:#ffb964;">physicsGravityFactorGroup</span><span>;
</span><span>        </span><span style="color:#8fbfdc;">public void </span><span style="color:#fad07a;">Execute </span><span>(TriggerEvent </span><span style="color:#ffb964;">triggerEvent</span><span>) {
</span><span>            </span><span style="color:#8fbfdc;">var </span><span style="color:#ffb964;">triggeredEntity </span><span>= </span><span style="color:#ffb964;">triggerEvent</span><span>.</span><span style="color:#ffb964;">Entities</span><span>.</span><span style="color:#ffb964;">EntityA</span><span>;
</span><span>            </span><span style="color:#8fbfdc;">if </span><span>(</span><span style="color:#ffb964;">playerInputGroup</span><span>.</span><span style="color:#ffb964;">Exists </span><span>(</span><span style="color:#ffb964;">triggeredEntity</span><span>))
</span><span>                </span><span style="color:#ffb964;">triggeredEntity </span><span>= </span><span style="color:#ffb964;">triggerEvent</span><span>.</span><span style="color:#ffb964;">Entities</span><span>.</span><span style="color:#ffb964;">EntityB</span><span>;
</span><span>            </span><span style="color:#8fbfdc;">var </span><span style="color:#ffb964;">cmpt </span><span>= </span><span style="color:#ffb964;">physicsGravityFactorGroup</span><span>[</span><span style="color:#ffb964;">triggeredEntity</span><span>];
</span><span>            </span><span style="color:#ffb964;">cmpt</span><span>.</span><span style="color:#ffb964;">Value </span><span>= </span><span style="color:#cf6a4c;">1</span><span>;
</span><span>            </span><span style="color:#ffb964;">physicsGravityFactorGroup</span><span>[</span><span style="color:#ffb964;">triggeredEntity</span><span>] = </span><span style="color:#ffb964;">cmpt</span><span>;
</span><span>        }
</span><span>    }
</span><span>    BuildPhysicsWorld </span><span style="color:#ffb964;">buildPhysicsWorld</span><span>;
</span><span>    StepPhysicsWorld </span><span style="color:#ffb964;">stepPhysicsWorld</span><span>;
</span><span>    </span><span style="color:#8fbfdc;">protected override void </span><span style="color:#fad07a;">OnCreate </span><span>() {
</span><span>        </span><span style="color:#ffb964;">buildPhysicsWorld </span><span>= </span><span style="color:#ffb964;">World</span><span>.</span><span style="color:#ffb964;">GetOrCreateSystem</span><span>&lt;BuildPhysicsWorld&gt; ();
</span><span>        </span><span style="color:#ffb964;">stepPhysicsWorld </span><span>= </span><span style="color:#ffb964;">World</span><span>.</span><span style="color:#ffb964;">GetOrCreateSystem</span><span>&lt;StepPhysicsWorld&gt; ();
</span><span>    }
</span><span>    </span><span style="color:#8fbfdc;">protected override </span><span>JobHandle </span><span style="color:#fad07a;">OnUpdate </span><span>(JobHandle </span><span style="color:#ffb964;">inputDeps</span><span>) {
</span><span>        </span><span style="color:#8fbfdc;">return </span><span>new DetectTriggerJob {
</span><span>            </span><span style="color:#ffb964;">playerInputGroup </span><span>= </span><span style="color:#ffb964;">GetComponentDataFromEntity</span><span>&lt;PlayerInput&gt; (true),
</span><span>                </span><span style="color:#ffb964;">physicsGravityFactorGroup </span><span>= </span><span style="color:#ffb964;">GetComponentDataFromEntity</span><span>&lt;PhysicsGravityFactor&gt; ()
</span><span>        }.</span><span style="color:#ffb964;">Schedule </span><span>(</span><span style="color:#ffb964;">stepPhysicsWorld</span><span>.</span><span style="color:#ffb964;">Simulation</span><span>, </span><span style="color:#8fbfdc;">ref </span><span style="color:#ffb964;">buildPhysicsWorld</span><span>.</span><span style="color:#ffb964;">PhysicsWorld</span><span>, </span><span style="color:#ffb964;">inputDeps</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<h2 id="chu-li-collision-shi-jian">处理 Collision 事件</h2>
<p>跟上文 Trigger 事件类似，也是使用 <code>JobComponentSystem</code>，Job 需要换成 <code>ICollisionEventsJob</code> 接口，然后调整 <code>Update</code> 的顺序并使用 <code>EndFramePhysicsSystem.HandlesToWaitFor</code> 处理同步，官方给的例子是有问题的，本文根据论坛作了一些修改</p>
<p>贴一下代码<br>
<code>DetectCollisionSystem.cs</code></p>
<pre data-lang="cs" style="background-color:#151515;color:#e8e8d3;" class="language-cs "><code class="language-cs" data-lang="cs"><span>[</span><span style="color:#ffb964;">UpdateAfter</span><span> (</span><span style="color:#ffb964;">typeof</span><span> (</span><span style="color:#ffb964;">StepPhysicsWorld</span><span>))]
</span><span>[</span><span style="color:#ffb964;">UpdateBefore</span><span> (</span><span style="color:#ffb964;">typeof</span><span> (</span><span style="color:#ffb964;">EndFramePhysicsSystem</span><span>))]
</span><span style="color:#8fbfdc;">public class </span><span style="color:#ffb964;">DetectCollisionSystem </span><span>: </span><span style="color:#ffb964;">JobComponentSystem </span><span>{
</span><span>    [</span><span style="color:#ffb964;">BurstCompile</span><span>]
</span><span>    </span><span style="color:#8fbfdc;">struct </span><span style="color:#ffb964;">DetectCollisionJob </span><span>: </span><span style="color:#ffb964;">ICollisionEventsJob </span><span>{
</span><span>        [</span><span style="color:#ffb964;">ReadOnly</span><span>] </span><span style="color:#8fbfdc;">public </span><span>ComponentDataFromEntity&lt;PlayerInput&gt; </span><span style="color:#ffb964;">playerInputGroup</span><span>;
</span><span>        </span><span style="color:#8fbfdc;">public </span><span>ComponentDataFromEntity&lt;PhysicsGravityFactor&gt; </span><span style="color:#ffb964;">physicsGravityFactorGroup</span><span>;
</span><span>        </span><span style="color:#8fbfdc;">public void </span><span style="color:#fad07a;">Execute </span><span>(CollisionEvent </span><span style="color:#ffb964;">collisionEvent</span><span>) {
</span><span>            </span><span style="color:#8fbfdc;">var </span><span style="color:#ffb964;">triggeredEntity </span><span>= </span><span style="color:#ffb964;">collisionEvent</span><span>.</span><span style="color:#ffb964;">Entities</span><span>.</span><span style="color:#ffb964;">EntityA</span><span>;
</span><span>            </span><span style="color:#8fbfdc;">if </span><span>(</span><span style="color:#ffb964;">playerInputGroup</span><span>.</span><span style="color:#ffb964;">Exists </span><span>(</span><span style="color:#ffb964;">triggeredEntity</span><span>))
</span><span>                </span><span style="color:#ffb964;">triggeredEntity </span><span>= </span><span style="color:#ffb964;">collisionEvent</span><span>.</span><span style="color:#ffb964;">Entities</span><span>.</span><span style="color:#ffb964;">EntityB</span><span>;
</span><span>            </span><span style="color:#8fbfdc;">var </span><span style="color:#ffb964;">cmpt </span><span>= </span><span style="color:#ffb964;">physicsGravityFactorGroup</span><span>[</span><span style="color:#ffb964;">triggeredEntity</span><span>];
</span><span>            </span><span style="color:#ffb964;">cmpt</span><span>.</span><span style="color:#ffb964;">Value </span><span>= </span><span style="color:#cf6a4c;">1</span><span>;
</span><span>            </span><span style="color:#ffb964;">physicsGravityFactorGroup</span><span>[</span><span style="color:#ffb964;">triggeredEntity</span><span>] = </span><span style="color:#ffb964;">cmpt</span><span>;
</span><span>        }
</span><span>    }
</span><span>    BuildPhysicsWorld </span><span style="color:#ffb964;">buildPhysicsWorld</span><span>;
</span><span>    StepPhysicsWorld </span><span style="color:#ffb964;">stepPhysicsWorld</span><span>;
</span><span>    EndFramePhysicsSystem </span><span style="color:#ffb964;">endFramePhysicsSystem</span><span>;
</span><span>    </span><span style="color:#8fbfdc;">protected override void </span><span style="color:#fad07a;">OnCreate </span><span>() {
</span><span>        </span><span style="color:#ffb964;">buildPhysicsWorld </span><span>= </span><span style="color:#ffb964;">World</span><span>.</span><span style="color:#ffb964;">GetOrCreateSystem</span><span>&lt;BuildPhysicsWorld&gt; ();
</span><span>        </span><span style="color:#ffb964;">stepPhysicsWorld </span><span>= </span><span style="color:#ffb964;">World</span><span>.</span><span style="color:#ffb964;">GetOrCreateSystem</span><span>&lt;StepPhysicsWorld&gt; ();
</span><span>        </span><span style="color:#ffb964;">endFramePhysicsSystem </span><span>= </span><span style="color:#ffb964;">World</span><span>.</span><span style="color:#ffb964;">GetOrCreateSystem</span><span>&lt;EndFramePhysicsSystem&gt; ();
</span><span>    }
</span><span>    </span><span style="color:#8fbfdc;">protected override </span><span>JobHandle </span><span style="color:#fad07a;">OnUpdate </span><span>(JobHandle </span><span style="color:#ffb964;">inputDeps</span><span>) {
</span><span>        </span><span style="color:#8fbfdc;">var </span><span style="color:#ffb964;">jobHandle </span><span>= new DetectCollisionJob {
</span><span>            </span><span style="color:#ffb964;">playerInputGroup </span><span>= </span><span style="color:#ffb964;">GetComponentDataFromEntity</span><span>&lt;PlayerInput&gt; (true), </span><span style="color:#ffb964;">physicsGravityFactorGroup </span><span>= </span><span style="color:#ffb964;">GetComponentDataFromEntity</span><span>&lt;PhysicsGravityFactor&gt; ()
</span><span>        }.</span><span style="color:#ffb964;">Schedule </span><span>(</span><span style="color:#ffb964;">stepPhysicsWorld</span><span>.</span><span style="color:#ffb964;">Simulation</span><span>, </span><span style="color:#8fbfdc;">ref </span><span style="color:#ffb964;">buildPhysicsWorld</span><span>.</span><span style="color:#ffb964;">PhysicsWorld</span><span>, </span><span style="color:#ffb964;">inputDeps</span><span>);
</span><span>        </span><span style="color:#ffb964;">endFramePhysicsSystem</span><span>.</span><span style="color:#ffb964;">HandlesToWaitFor</span><span>.</span><span style="color:#ffb964;">Add </span><span>(</span><span style="color:#ffb964;">jobHandle</span><span>);
</span><span>        </span><span style="color:#8fbfdc;">return </span><span style="color:#ffb964;">jobHandle</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>

        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Thanks for reading! Read other posts?</span>
                    <hr />
                </div>
                <div class="pagination__buttons">
                        <span class="button previous">
                            <a href="https://paakmau.github.io/202002082155/">
                                <span class="button__icon">←</span>&nbsp;
                                <span class="button__text">Unity Physics 学习笔记第五章：核心组件</span>
                            </a>
                        </span>
                    
                    
                        <span class="button next">
                            <a href="https://paakmau.github.io/202003152207/">
                                <span class="button__text">Unity Physics 学习笔记第七章：精确的碰撞管理</span>&nbsp;
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    </div>
            </div>
        
    </div>

    </div>

    
    <footer class="footer">
        <div class="footer__inner">
                <div class="copyright">
                        <span>© 
    2025
 Powered by <a href="https://www.getzola.org/">Zola</a></span>
                    <span class="copyright-theme">
                        <span class="copyright-theme-sep">:: </span>
                        Theme: <a href="https://github.com/pawroman/zola-theme-terminimal/">Terminimal</a> by pawroman
                    </span>
                </div>
            </div>
    </footer>
    

</div>
</body>

</html>
